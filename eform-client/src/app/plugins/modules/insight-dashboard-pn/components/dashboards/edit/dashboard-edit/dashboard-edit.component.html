<subheader-pn [title]="'Edit Dashboard' | translate">
  <div class="p-3">
    <button
      id="dashboardUpdateSaveBtn"
      class="btn btn-success" [disabled]="!dashboardEditModel.locationId && !dashboardEditModel.tagId"
      (click)="updateDashboard()">{{ 'Save' | translate }}
    </button>
    <button
      id="dashboardUpdateSaveCancelBtn"
      class="btn btn-accent text-black-50"
      [routerLink]="['../../../dashboards']">{{ 'Cancel' | translate }}
    </button>
  </div>
</subheader-pn>

<div class="container-fluid">
  <app-dashboard-edit-header [availableLocationsTags]="availableLocationsTags"
                             (dashboardChanged)="onDashboardChanged($event)"
                             [dashboardEditModel]="dashboardEditModel"></app-dashboard-edit-header>
  <div class="card z-depth-3" style="width: 100%">
    <div class="card-body">
      <div class="row">
        <div class="col">
          <button
            id="initialItemCreateBtn"
            class="btn btn-success mb-1 mt-1" *ngIf="dashboardEditModel.items.length === 0"
            (click)="onAddNewBlock(1)">{{ 'Add new item' | translate }}
          </button>
          <ng-container *ngIf="dashboardEditModel.items.length > 0">
            <a class="float-right page-link mb-2"  *ngIf="isItemsCollapsed"
               (click)="toggleCollapse()" mdbTooltip="{{'Expand all' | translate}}">
              <fa-icon icon="expand-arrows-alt" size="lg" [fixedWidth]="true"></fa-icon>
            </a>
            <a class="float-right page-link mb-2" *ngIf="!isItemsCollapsed"
               (click)="toggleCollapse()" mdbTooltip="{{'Collapse all' | translate}}">
              <fa-icon icon="compress-arrows-alt" size="lg" [fixedWidth]="true"></fa-icon>
            </a>
          </ng-container>
        </div>
      </div>
      <section dragula="ITEMS" id="dashboardItems"
               (dragulaModelChange)="dragulaPositionChanged($event)"
               [dragulaModel]="dashboardEditModel.items">
        <app-dashboard-item-edit *ngFor="let dashboardItem of dashboardEditModel.items"
                                 [dashboardItem]="dashboardItem"
                                 [locationsTags]="availableLocationsTags"
                                 [questions]="questions"
                                 id="dashboardItem"
                                 [surveyId]="dashboardEditModel.surveyId"
                                 (addNewItem)="onAddNewBlock($event)"
                                 (copyItem)="onCopyBlock($event)"
                                 (deleteItem)="onDeleteBlock($event)"
                                 [ngClass]="{'no-drag' : !dashboardItem.collapsed}"
                                 (dashboardItemChanged)="onDashboardItemChanged($event)"></app-dashboard-item-edit>
      </section>
    </div>
  </div>
</div>

<spinner-pn [spinnerVisibility]="spinnerStatus"></spinner-pn>
