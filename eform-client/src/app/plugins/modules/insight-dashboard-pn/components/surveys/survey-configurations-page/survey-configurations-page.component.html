<subheader-pn [title]="'Surveys' | translate">
  <div class="p-3">
    <button
      id="createSurveyConfigButton"
      class="btn btn-success"
      (click)="openCreateModal()">{{ 'New Survey Config' | translate }}
    </button>
  </div>
</subheader-pn>

<div class="container-fluid">
  <div class="row pl-1">
    <div class="col-md-2">
      <div class="md-form">
        <input mdbInputDirective [mdbValidate]="false"
               type="text" (input)="onSearchInputChanged($event)"
               class="form-control input-sm" id="searchInput">
        <label for="searchInput">{{'Search' | translate}}</label>
      </div>
    </div>
  </div>
  <div class="container-fluid">
    <div class="row p-1 mt-4 table-responsive no-gutters" *ngIf="surveyConfigurationsListModel.total !== 0">
      <table class="table table-sm table-striped text-center z-depth-1">
        <thead>
        <tr>
          <th scope="col" class="table-header-sortable" id="idTableHeader" (click)="sortTable(sortCols.id)">
            <div class="d-flex align-items-center justify-content-center">
              ID
              <i class="material-icons text-black-50">{{getSortIcon(sortCols.id)}}</i>
            </div>
          </th>
          <th scope="col" class="table-header-sortable" id="surveyNameTableHeader"
              (click)="sortTable(sortCols.surveyName)">
            <div class="d-flex align-items-center justify-content-center">
              {{ 'Survey name' | translate }}
              <i class="material-icons text-black-50">{{getSortIcon(sortCols.surveyName)}}</i>
            </div>
          </th>
          <th scope="col" class="table-header-sortable" id="locationNameTableHeader"
              (click)="sortTable(sortCols.locationName)">
            <div class="d-flex align-items-center justify-content-center">
              {{ 'Location name' | translate }}
              <i class="material-icons text-black-50">{{getSortIcon(sortCols.locationName)}}</i>
            </div>
          </th>
          <th scope="col">
            {{ 'Actions' | translate }}
          </th>
        </tr>
        </thead>
        <tbody id="tableBody">
        <tr *ngFor="let surveyConfig of surveyConfigurationsListModel?.surveyList; let i = index">
          <td id="surveyConfigId">
            {{surveyConfig.id}}
          </td>
          <td id="surveyConfigName">
            {{surveyConfig.name}}
          </td>
          <td id="surveyConfigLocation">
            {{surveyConfig.locationName}}
          </td>
          <td>
            <div class="d-flex flex-row justify-content-center">
              <button class="btn btn-accent text-black-50 btn-icon mb-2 " id="editSurveyConfigBtn"
                      mdbTooltip="{{'Edit Survey Config' | translate}}" mdbWavesEffect
                      (click)="openEditModal(surveyConfig)">
                <fa-icon icon="pen" [fixedWidth]="true" size="lg"></fa-icon>
              </button>
              <div id="surveyConfigStatus">
                <button (click)="openStatusModal()"
                  mdbTooltip="{{'Activate Survey' | translate}}"
                  class="btn btn-accent text-black-50 btn-icon mb-2">
                  <fa-icon icon="toggle-on" [fixedWidth]="true" size="lg"></fa-icon>
                </button>
              </div>
              <button id="surveyConfigDeleteBtn"
                      class="btn btn-danger btn-icon mb-2 "
                      mdbTooltip="{{'Delete Worker' | translate}}"
                      (click)="openDeleteModal(surveyConfig)">
                <fa-icon icon="trash-alt" [fixedWidth]="true" size="lg"></fa-icon>
              </button>
            </div>

            <!--            <div [ngStyle]="{'color': plugin.status == statusEnum.Enabled ? '#06ba06' : '#ba3f4e'}" id="plugin-status">-->
            <!--              <button *ngIf="plugin.status == statusEnum.Disabled"-->
            <!--                      mdbTooltip="{{'Activate plugin' | translate}}"-->
            <!--                      class="btn btn-accent text-black-50 btn-icon mb-2"-->
            <!--                      (click)="openPluginModal(plugin, statusEnum.Enabled)">-->
            <!--                <fa-icon icon="toggle-on"></fa-icon>-->
            <!--              </button>-->
            <!--              <button *ngIf="plugin.status == statusEnum.Enabled"-->
            <!--                      mdbTooltip="{{'Deactivate plugin' | translate}}"-->
            <!--                      class="btn btn-success text-black-50 btn-icon mb-2"-->
            <!--                      (click)="openPluginModal(plugin, statusEnum.Disabled)">-->
            <!--                <fa-icon icon="toggle-off"></fa-icon>-->
            <!--              </button>-->
            <!--            </div>-->
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="row p-1 my-4 mx-2" *ngIf="surveyConfigurationsListModel.total === 0">
    <span>{{'No survey configs found' | translate}}</span>
  </div>
  <div class="row justify-content-between mr-2 ml-2">
    <div class="col-md-1">
      <page-size-pn
        [pageSize]="localPageSettings.pageSize"
        (onPageSizeChanged)="localPageSettings.pageSize = $event; surveyConfigurationsRequestModel.offset = 0;
        updateLocalPageSettings()"
      ></page-size-pn>
    </div>
    <pagination-pn
      *ngIf="surveyConfigurationsListModel?.total > surveyConfigurationsRequestModel.pageSize"
      [limit]="surveyConfigurationsRequestModel.pageSize"
      [size]="surveyConfigurationsListModel.total"
      [offset]="surveyConfigurationsRequestModel.offset"
      (onPageChanged)="changePage($event)"
    ></pagination-pn>
  </div>
</div>

<spinner-pn [spinnerVisibility]="spinnerStatus"></spinner-pn>

<app-survey-configuration-status
  #statusSurveyConfigModal [isSurveyConfigActivated]="false" (statusChanged)="onSurveyConfigStatusChanged($event)"
></app-survey-configuration-status>
<app-survey-configuration-edit #editSurveyConfigModal></app-survey-configuration-edit>
<app-survey-configuration-new #newSurveyConfigModal></app-survey-configuration-new>
<app-survey-configuration-delete #deleteSurveyConfigModal></app-survey-configuration-delete>
<!--<app-installation-assign-->
<!--  #assignInstallationModal (installationAssigned)="getInstallationsList()"-->
<!--&gt;</app-installation-assign>-->
<!--<app-installation-retract-->
<!--  #retractInstallationModal (installationRetracted)="getInstallationsList()"-->
<!--&gt;</app-installation-retract>-->
